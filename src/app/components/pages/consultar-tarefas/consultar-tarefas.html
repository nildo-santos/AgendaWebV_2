<app-navbar />

<div class="container mt-3">
    <div class="card shadow p-3 mb-5 bg-body rounded">
        <div class="card-body">
            <h4>Consulta de tarefas</h4>
            <p>Selecione o período de datas desejado para consultar as tarefas da agenda.</p>
            <hr />

            <form [formGroup]="formConsulta" (ngSubmit)="consultarTarefas()">
                <div class="row">
                    <div class="col">
                        <input type="date" class="form-control" formControlName="dataMin" />
                        <div class="text-danger"
                            *ngIf="formConsulta.get('dataMin')?.touched && formConsulta.get('dataMin')?.invalid">
                            Por favor, informe a data de início.
                        </div>
                    </div>
                    <div class="col">
                        <input type="date" class="form-control" formControlName="dataMax" />
                        <div class="text-danger"
                            *ngIf="formConsulta.get('dataMax')?.touched && formConsulta.get('dataMax')?.invalid">
                            Por favor, informe a data de fim.
                        </div>
                    </div>
                    <div class="col">
                        <input type="submit" class="btn btn-success" value="Pesquisar tarefas"
                            [ngClass]="{'btn-success': formConsulta.valid, 'btn-secondary': formConsulta.invalid}"
                            [disabled]="formConsulta.invalid" />
                    </div>
                </div>
            </form>

            <table *ngIf="tarefas().length > 0" class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Nome da tarefa</th>
                        <th>Data</th>
                        <th>Prioridade</th>
                        <th>Finalizado</th>
                        <th>Categoria</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of tarefas()">
                        <td>{{ item.nome | uppercase }}</td>
                        <td>{{ item.data | date: 'dd/MM/yyyy' }}</td>
                        <td>{{ item.prioridade }}</td>
                        <td>
                            <div *ngIf="item.finalizado" class="badge bg-success">
                                SIM
                            </div>
                            <div *ngIf="!item.finalizado" class="badge bg-danger">
                                NÃO
                            </div>
                        </td>
                        <td>{{ item.categoria.nome }}</td>
                        <td>
                        <td>
                            <button #btnAcao class="btn btn-outline-primary btn-sm me-1">Editar</button>
                            <button #btnAcao class="btn btn-outline-danger btn-sm me-1"
                                (click)="excluirTarefa(item.id)">Excluir</button>
                        </td>


                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>